let authToken;window.webpackChunkdiscord_app.push([[Math.random()],{},e=>{if(e.c)for(const n of Object.keys(e.c).map((n=>e.c[n].exports)).filter((e=>e))){if(n.default&&void 0!==n.default.getToken)return void(authToken=n.default.getToken());if(void 0!==n.getToken)return void(authToken=n.getToken())}}]),window.webpackChunkdiscord_app.pop();const channelId=window.location.pathname.split("/")[3];function fetchUserInfo(){return fetch("https://discord.com/api/v9/users/@me",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9",authorization:authToken,"content-type":"application/json"},method:"GET",mode:"cors",credentials:"include"}).then((e=>e.json())).then((e=>({id:e.id,username:e.global_name}))).catch((e=>{throw console.error("Error fetching user info:",e),e}))}function processDirectMessageLeaderboard(e){return fetchUserInfo().then((n=>{const t=n.id,o=n.username,a=e.channels[0].recipients.find((e=>e.id!==t)),s=e.total_results,r=[fetchMessageCount(t,o),fetchMessageCount(a.id,a.global_name)];return Promise.all(r).then((e=>{e.sort(((e,n)=>n.messageCount-e.messageCount));let n=`**DM with ${a.global_name}**\n**Total messages:** ${s}\n\n**Leaderboard:** 🏆\n`;e.forEach(((e,t)=>{const o=(e.messageCount/s*100).toFixed(1);n+=`${t+1}. **${e.username}**: ${e.messageCount} (${o}%)\n`}));return sendLeaderboardMessage({content:n,tts:!1})}))}))}function processGroupMessageLeaderboard(e){const n=e.channels[0].name,t=e.total_results,o=e.channels[0].recipients;return fetchUserInfo().then((e=>{const a=e.id,s=e.username,r=[],c=o.map((e=>fetchMessageCount(e.id,e.global_name).then((e=>r.push(e))).catch((n=>console.error(`Error fetching message count for ${e.global_name}:`,n)))));return c.push(fetchMessageCount(a,s).then((e=>r.push(e))).catch((e=>console.error("Error fetching message count for self:",e)))),Promise.all(c).then((()=>{r.sort(((e,n)=>n.messageCount-e.messageCount));let e=`**Group Name:** ${n}\n**Total messages:** ${t}\n\n**Leaderboard:** 🏆\n`;r.forEach(((n,o)=>{const a=(n.messageCount/t*100).toFixed(1);e+=`${o+1}. **${n.username}**: ${n.messageCount} (${a}%)\n`}));return sendLeaderboardMessage({content:e,tts:!1})}))}))}function fetchMessageCount(e,n){return fetch(`https://discord.com/api/v9/channels/${channelId}/messages/search?min_id=0&author_id=${e}`,{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9",authorization:authToken,"content-type":"application/json"},method:"GET",mode:"cors",credentials:"include"}).then((e=>e.json())).then((t=>({username:n,userId:e,messageCount:t.total_results})))}function sendLeaderboardMessage(e){return fetch(`https://discord.com/api/v9/channels/${channelId}/messages`,{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9",authorization:authToken,"content-type":"application/json"},body:JSON.stringify(e),method:"POST",mode:"cors",credentials:"include"})}fetch(`https://discord.com/api/v9/channels/${channelId}/messages/search?min_id=0`,{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9",authorization:authToken,"content-type":"application/json","x-debug-options":"bugReporterEnabled","x-discord-locale":"en-US","x-discord-timezone":"Europe/Paris"},method:"GET",mode:"cors",credentials:"include"}).then((e=>e.json())).then((e=>void 0===e.channels[0].name?processDirectMessageLeaderboard(e):processGroupMessageLeaderboard(e))).catch((e=>{console.error("Error fetching channel data:",e)}));